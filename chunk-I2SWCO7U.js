import{A as o,f as m,g as d,h as b,k as c,l as u,n as l,o as j,p as k,ra as g,t as h,wa as w,x as n,za as f}from"./chunk-4WTJQ336.js";var S=(()=>{let e=class e{constructor(t){this.http=t,this.apiUrl="http://localhost:3000"}getUsers(){let t=`${this.apiUrl}/users`;return this.http.get(t).pipe(l(r=>(console.error("Error fetching users:",r),c(r))))}addUser(t){let r=`${this.apiUrl}/users`;return this.getUsers().pipe(j(1),h(a=>a.find(i=>i.username===t.username)?c('Username "'+t.username+'" is already taken'):this.http.post(r,t)))}authenticate(t,r){let a=`${this.apiUrl}/users`;return this.getUsers().pipe(k(500),l(()=>c("Error al obtener usuarios")),u(i=>{if(!i.find(p=>p.username===t&&p.password===r))throw new Error("Credenciales incorrectas");return{token:"fake-jwt-token"}}))}logout(){return new m(t=>{t.complete()})}};e.\u0275fac=function(r){return new(r||e)(o(g))},e.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var F=(()=>{let e=class e{constructor(t,r){this.router=t,this.fakeBackendService=r,this.userSubject=new b(JSON.parse(localStorage.getItem("user"))),this.user=this.userSubject.asObservable()}get userValue(){return this.userSubject.value}login(t,r){return this.fakeBackendService.authenticate(t,r).pipe(h(a=>{let i={username:t,token:a.token};return localStorage.setItem("user",JSON.stringify(i)),this.userSubject.next(i),this.fakeBackendService.getUsers()}),u(a=>a.find(i=>i.username===t)))}logout(){localStorage.removeItem("user"),this.userSubject.next(null),this.router.navigate(["/login"])}register(t){return this.fakeBackendService.addUser(t)}};e.\u0275fac=function(r){return new(r||e)(o(f),o(S))},e.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var J=(()=>{let e=class e{constructor(t){this.router=t,this.subject=new d,this.showAfterRedirect=!1,this.router.events.subscribe(r=>{r instanceof w&&(this.showAfterRedirect?this.showAfterRedirect=!1:this.clear())})}onAlert(){return this.subject.asObservable()}success(t,r=!1){this.showAfterRedirect=r,this.subject.next({type:"success",message:t})}error(t,r=!1){this.showAfterRedirect=r,this.subject.next({type:"error",message:t})}clear(){this.subject.next(null)}};e.\u0275fac=function(r){return new(r||e)(o(f))},e.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();export{S as a,F as b,J as c};

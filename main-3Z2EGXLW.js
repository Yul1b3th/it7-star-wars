import"./chunk-APEKR53Y.js";import{a as ct,b as c}from"./chunk-I2SWCO7U.js";import{$ as n,A as u,Aa as A,Ba as at,C as f,Ca as st,Da as x,G as J,H as K,J as $,P as y,Q as S,T as Q,V as X,W as F,_ as a,a as N,aa as m,b as U,ba as Y,da as Z,ea as q,ga as v,j as D,k as C,ka as h,la as _,n as M,o as V,p as I,pa as k,q as B,qa as tt,s as z,sa as w,t as R,ta as et,u as G,ua as rt,va as ot,x as d,ya as it,za as nt}from"./chunk-4WTJQ336.js";var mt=(()=>{let t=class t{constructor(o,e){this.router=o,this.accountService=e}canActivate(o,e){return this.accountService.userValue?!0:(this.router.navigate(["/login"],{queryParams:{returnUrl:e.url}}),!1)}};t.\u0275fac=function(e){return new(e||t)(u(nt),u(c))},t.\u0275prov=d({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var pt=(()=>{let t=class t{constructor(o){this.accountService=o}intercept(o,e){return e.handle(o).pipe(M(i=>{[401,403].includes(i.status)&&this.accountService.userValue&&this.accountService.logout();let g=i.error?.message||i.statusText;return console.error(i),C(()=>g)}))}};t.\u0275fac=function(e){return new(e||t)(u(c))},t.\u0275prov=d({token:t,factory:t.\u0275fac});let r=t;return r})();var ut="angular-tutorial-users",j=JSON.parse(localStorage.getItem(ut))||[],Et=(()=>{let t=class t{constructor(o){this.prueba=o}intercept(o,e){let{url:i,method:g,headers:O,body:H}=o,Ct=()=>{let s=H;return this.prueba.getUsers().pipe(V(1),G(p=>{console.log("Backend Users:",p)}),R(p=>p.find(l=>l.username===s.username)?W('Username "'+s.username+'" is already taken'):(s.id=j.length?Math.max(...j.map(l=>l.id))+1:1,j.push(s),localStorage.setItem(ut,JSON.stringify(j)),this.prueba.addUser(s).pipe(R(()=>P())))),M(p=>(console.error("Error in register:",p),C(p))))};return console.log(this.prueba),yt();function yt(){switch(!0){case(i.endsWith("/users/authenticate")&&g==="POST"):return wt();case(i.endsWith("/users/register")&&g==="POST"):return Ct();default:return e.handle(o)}}function wt(){let{username:s,password:p}=H,l=j.find(E=>E.username===s&&E.password===p);return l?P(U(N({},Tt(l)),{token:"fake-jwt-token"})):W("Username or password is incorrect")}function P(s){return D(new tt({status:200,body:s})).pipe(I(500))}function W(s){return C(()=>({error:{message:s}})).pipe(z(),I(500),B())}function Tt(s){let{id:p,username:l,firstName:E,lastName:jt}=s;return{id:p,username:l,firstName:E,lastName:jt}}}};t.\u0275fac=function(e){return new(e||t)(u(ct))},t.\u0275prov=d({token:t,factory:t.\u0275fac});let r=t;return r})(),lt={provide:w,useClass:Et,multi:!0};var dt={apiUrl:"http://localhost:4200"};var ft=(()=>{let t=class t{constructor(o){this.accountService=o}intercept(o,e){let i=this.accountService.userValue,g=i?.token,O=o.url.startsWith(dt.apiUrl);return g&&O&&(o=o.clone({setHeaders:{Authorization:`Bearer ${i.token}`}})),e.handle(o)}};t.\u0275fac=function(e){return new(e||t)(u(c))},t.\u0275prov=d({token:t,factory:t.\u0275fac});let r=t;return r})();var vt=[{path:"",title:"Star Wars",loadComponent:()=>import("./chunk-46IRWOMS.js")},{path:"login",title:"Star Wars | Login",loadComponent:()=>import("./chunk-PA42PONR.js")},{path:"register",title:"Register",loadComponent:()=>import("./chunk-E3JCH7ZJ.js")},{path:"starships",title:"Star Wars | Starships",loadComponent:()=>import("./chunk-HJYACVK5.js"),canActivate:[mt]},{path:"starship/:id",title:"Star Wars | Starship",loadComponent:()=>import("./chunk-NKRGI3BT.js")},{path:"**",title:"Star Wars",redirectTo:"",pathMatch:"full"}];var ht={providers:[st(vt),$(et),ot(),{provide:w,useClass:ft,multi:!0},{provide:w,useClass:pt,multi:!0},lt]};function Mt(r,t){r&1&&(a(0,"button",9),v(1,"LOG IN"),n())}function At(r,t){if(r&1){let xt=Y();a(0,"button",10),Z("click",function(){J(xt);let e=q();return K(e.logout())}),v(1,"LOG OUT"),n()}}var bt=(()=>{let t=class t{constructor(o){this.accountService=o,this.accountService.user.subscribe(e=>this.user=e)}logout(){this.accountService.logout()}};t.\u0275fac=function(e){return new(e||t)(S(c))},t.\u0275cmp=f({type:t,selectors:[["app-header"]],standalone:!0,features:[h],decls:10,vars:2,consts:[[1,"px-5"],[1,"container-fluid","p-4","d-flex","justify-content-between","align-items-center","flex-wrap","gap-2"],["src","assets/networks.jpg","alt","Star Wars"],[1,"logo"],["routerLink",""],["src","assets/logo.png","alt","","height","80"],[1,"account"],["class","btn btn-link nav-item nav-link","routerLink","../login"],["class","btn btn-link nav-item nav-link"],["routerLink","../login",1,"btn","btn-link","nav-item","nav-link"],[1,"btn","btn-link","nav-item","nav-link",3,"click"]],template:function(e,i){e&1&&(a(0,"header",0)(1,"div",1)(2,"div"),m(3,"img",2),n(),a(4,"div",3)(5,"a",4),m(6,"img",5),n()(),a(7,"div",6),X(8,Mt,2,0,"button",7)(9,At,2,0,"button",8),n()()()),e&2&&(y(8),F(8,i.user?-1:8),y(1),F(9,i.user?9:-1))},dependencies:[k,x,A],styles:[".account[_ngcontent-%COMP%]{width:262px;display:flex;justify-content:flex-end}"]});let r=t;return r})();var gt=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=f({type:t,selectors:[["app-footer"]],standalone:!0,features:[h],decls:4,vars:0,consts:[[1,"container","text-center","p-5"],["src","assets/networks.jpg","alt","Star Wars"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"p"),v(2,"More From Star Wars:"),n(),m(3,"img",1),n())}});let r=t;return r})();var It=()=>({exact:!0}),St=(()=>{let t=class t{constructor(o){this.accountService=o,this.accountService.user.subscribe(e=>this.user=e)}logout(){this.accountService.logout()}};t.\u0275fac=function(e){return new(e||t)(S(c))},t.\u0275cmp=f({type:t,selectors:[["app-navbar"]],standalone:!0,features:[h],decls:12,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark","border-white","border-top","border-bottom","p-0"],[1,"container-fluid"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","mx-auto"],[1,"nav-item","border-end","border-start"],["routerLink","","routerLinkActive","active border-bottom border-2 border-primary",1,"nav-link",3,"routerLinkActiveOptions"],[1,"nav-item","border-end"],["routerLink","../starships","routerLinkActive","active border-bottom border-2 border-primary",1,"nav-link"]],template:function(e,i){e&1&&(a(0,"nav",0)(1,"div",1)(2,"button",2),m(3,"span",3),n(),a(4,"div",4)(5,"ul",5)(6,"li",6)(7,"a",7),v(8,"HOME"),n()(),a(9,"li",8)(10,"a",9),v(11,"STARSHIPS"),n()()()()()()),e&2&&(y(7),Q("routerLinkActiveOptions",_(1,It)))},dependencies:[k,x,A,at]});let r=t;return r})();var kt=(()=>{let t=class t{constructor(o){this.accountService=o,this.title="Star Wars",this.accountService.user.subscribe(e=>this.user=e)}logout(){this.accountService.logout()}};t.\u0275fac=function(e){return new(e||t)(S(c))},t.\u0275cmp=f({type:t,selectors:[["app-root"]],standalone:!0,features:[h],decls:5,vars:0,consts:[[1,"mt-auto"]],template:function(e,i){e&1&&(m(0,"app-header")(1,"app-navbar"),a(2,"div"),m(3,"router-outlet"),n(),m(4,"app-footer",0))},dependencies:[k,x,it,bt,gt,St]});let r=t;return r})();rt(kt,ht).catch(r=>console.error(r));
